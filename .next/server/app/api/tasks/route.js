(()=>{var e={};e.id=456,e.ids=[456],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},12412:e=>{"use strict";e.exports=require("assert")},14985:e=>{"use strict";e.exports=require("dns")},18522:(e,s,t)=>{"use strict";t.r(s),t.d(s,{patchFetch:()=>q,routeModule:()=>m,serverHooks:()=>h,workAsyncStorage:()=>f,workUnitAsyncStorage:()=>k});var r={};t.r(r),t.d(r,{GET:()=>g,POST:()=>x});var a=t(96559),i=t(48088),o=t(37719),n=t(67857),u=t(32190),c=t(43205),p=t.n(c),d=t(65054);let l=process.env.JWT_SECRET;async function x(e){try{let s;let{title:t,description:r}=await e.json();if(!t||!r)return u.NextResponse.json({success:!1,message:"Title and description are required"},{status:400});let a=e.headers.get("authorization");if(!a||!a.startsWith("Bearer "))return u.NextResponse.json({success:!1,message:"Unauthorized: No token provided"},{status:401});let i=a.split(" ")[1];try{s=p().verify(i,l)}catch(e){return u.NextResponse.json({success:!1,message:"Invalid or expired token"},{status:401})}let o=s.id;if(!o)return u.NextResponse.json({success:!1,message:"Invalid token: User ID not found"},{status:401});if(!await n.A.user.findUnique({where:{id:o}}))return u.NextResponse.json({success:!1,message:"User not found"},{status:404});let c=await n.A.task.create({data:{title:t,description:r,userId:o}});return await d.A.del(`tasks:${o}`),u.NextResponse.json({success:!0,task:c},{status:201})}catch(e){return u.NextResponse.json({success:!1,message:e.message},{status:500})}}async function g(e){try{let s=e.headers.get("authorization");if(!s||!s.startsWith("Bearer "))return u.NextResponse.json({success:!1,message:"Unauthorized"},{status:401});let t=s.split(" ")[1],r=p().verify(t,l).id,a=await d.A.get(`tasks:${r}`);if(a)return console.log("Serving from Redis Cache"),u.NextResponse.json(JSON.parse(a));let i=await n.A.task.findMany({where:{userId:r}});return await d.A.set(`tasks:${r}`,JSON.stringify(i),"EX",60),console.log("Serving from PostgreSQL"),u.NextResponse.json(i)}catch(e){return u.NextResponse.json({success:!1,message:e.message},{status:500})}}let m=new a.AppRouteRouteModule({definition:{kind:i.RouteKind.APP_ROUTE,page:"/api/tasks/route",pathname:"/api/tasks",filename:"route",bundlePath:"app/api/tasks/route"},resolvedPagePath:"D:\\Downloads\\Taskoo\\TaskManage\\src\\app\\api\\tasks\\route.js",nextConfigOutput:"",userland:r}),{workAsyncStorage:f,workUnitAsyncStorage:k,serverHooks:h}=m;function q(){return(0,o.patchFetch)({workAsyncStorage:f,workUnitAsyncStorage:k})}},21820:e=>{"use strict";e.exports=require("os")},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},34631:e=>{"use strict";e.exports=require("tls")},41204:e=>{"use strict";e.exports=require("string_decoder")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},55511:e=>{"use strict";e.exports=require("crypto")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},65054:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});var r=t(70300);let a=new(t.n(r)())({host:"redis-17924.crce179.ap-south-1-1.ec2.redns.redis-cloud.com",port:17924,password:"XSFmdGSPZwzS5zUkEsW6dXsd2AlHaLnm"})},67857:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=new(t(96330)).PrismaClient},78335:()=>{},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},83997:e=>{"use strict";e.exports=require("tty")},91645:e=>{"use strict";e.exports=require("net")},94735:e=>{"use strict";e.exports=require("events")},96330:e=>{"use strict";e.exports=require("@prisma/client")},96487:()=>{}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[243,580,300,205],()=>t(18522));module.exports=r})();
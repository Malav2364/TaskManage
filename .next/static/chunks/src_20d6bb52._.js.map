{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file://D%3A/Downloads/Taskoo/TaskManage/src/components/taskForm.jsx"],"sourcesContent":["// components/taskForm.jsx\r\n\"use client\";\r\n\r\nimport { useState, useRef, useEffect } from \"react\";\r\nimport { createPortal } from \"react-dom\";\r\nimport { useSession } from \"next-auth/react\";\r\nimport axios from \"axios\";\r\nimport toast from \"react-hot-toast\";\r\n\r\nexport default function TaskForm({ onTaskAdded }) {\r\n  const { data: session } = useSession();\r\n  const [isModalOpen, setIsModalOpen] = useState(false);\r\n  const [mounted, setMounted] = useState(false);\r\n  const [formData, setFormData] = useState({\r\n    title: \"\",\r\n    description: \"\"\r\n  });\r\n  const [loading, setLoading] = useState(false);\r\n  \r\n  const titleInputRef = useRef(null);\r\n  const buttonRef = useRef(null);\r\n  const overlayRef = useRef(null);\r\n  \r\n  // Current user and timestamp values as specified in the latest update\r\n  const currentUser = session?.user?.email;\r\n  const currentDateTime = new Date().toLocaleDateString();\r\n  \r\n  // Setup portal mounting on component init\r\n  useEffect(() => {\r\n    setMounted(true);\r\n    return () => setMounted(false);\r\n  }, []);\r\n  \r\n  // Focus input once when modal opens\r\n  useEffect(() => {\r\n    if (isModalOpen && titleInputRef.current) {\r\n      setTimeout(() => {\r\n        titleInputRef.current.focus();\r\n      }, 100);\r\n    }\r\n  }, [isModalOpen]);\r\n  \r\n  // Lock/unlock body scroll when modal is open\r\n  useEffect(() => {\r\n    if (isModalOpen) {\r\n      document.body.style.overflow = 'hidden';\r\n    } else {\r\n      document.body.style.overflow = '';\r\n    }\r\n    \r\n    return () => {\r\n      document.body.style.overflow = '';\r\n    };\r\n  }, [isModalOpen]);\r\n  \r\n  const openModal = () => setIsModalOpen(true);\r\n  const closeModal = () => setIsModalOpen(false);\r\n  \r\n  // Use a single handler function with computed property names\r\n  const handleInputChange = (e) => {\r\n    const { name, value } = e.target;\r\n    setFormData(prev => ({\r\n      ...prev,\r\n      [name]: value\r\n    }));\r\n  };\r\n  \r\n  const handleBackdropClick = (e) => {\r\n    if (e.target === overlayRef.current) {\r\n      if (!formData.title && !formData.description) {\r\n        closeModal();\r\n      } else {\r\n        // Show toast if user tries to close with data entered\r\n        toast.error(\"Please use the Cancel button to discard your task\");\r\n      }\r\n    }\r\n  };\r\n  \r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    \r\n    if (!formData.title.trim()) {\r\n      toast.error(\"Please enter a task title\");\r\n      return;\r\n    }\r\n    \r\n    // Show loading toast\r\n    const loadingToast = toast.loading(\"Adding task...\");\r\n    setLoading(true);\r\n    \r\n    try {\r\n      const token = session?.user?.token;\r\n      if (!token) {\r\n        throw new Error(\"Authentication token missing\");\r\n      }\r\n      \r\n      const response = await axios.post(\"/api/tasks\", \r\n        {\r\n          title: formData.title.trim(),\r\n          description: formData.description.trim(),\r\n          completed: false\r\n        }, \r\n        {\r\n          headers: {\r\n            Authorization: `Bearer ${token}`\r\n          }\r\n        }\r\n      );\r\n      \r\n      // Update loading toast to success\r\n      toast.success(\"Task added successfully!\", { id: loadingToast });\r\n      \r\n      // Reset form\r\n      setFormData({ title: \"\", description: \"\" });\r\n      closeModal();\r\n      \r\n      // Update parent component\r\n      if (onTaskAdded) onTaskAdded(response.data);\r\n      \r\n    } catch (error) {\r\n      console.error(\"Error adding task:\", error);\r\n      // Update loading toast to error\r\n      toast.error(error.response?.data?.message || \"Failed to add task\", { id: loadingToast });\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n  \r\n  const handleCancel = () => {\r\n    if (formData.title.trim() || formData.description.trim()) {\r\n      toast.success(\"Task creation cancelled\");\r\n    }\r\n    setFormData({ title: \"\", description: \"\" });\r\n    closeModal();\r\n  };\r\n  \r\n  // Button component - always in the normal DOM\r\n  const AddButton = (\r\n    <button\r\n      ref={buttonRef}\r\n      onClick={openModal}\r\n      className=\"focus:outline-none text-white bg-red-500 hover:bg-red-700 focus:ring-4 focus:ring-red-300 font-medium rounded-xl text-sm p-2 m-1\"\r\n      aria-label=\"Add task\"\r\n      type=\"button\"\r\n    >\r\n      <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\r\n        <path fillRule=\"evenodd\" d=\"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z\" clipRule=\"evenodd\" />\r\n      </svg>\r\n    </button>\r\n  );\r\n  \r\n  // Modal component - rendered via Portal\r\n  const TaskFormModal = (\r\n    <div \r\n      ref={overlayRef}\r\n      className=\"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/30 backdrop-blur-sm\"\r\n      onClick={handleBackdropClick}\r\n    >\r\n      <div \r\n        className=\"bg-white rounded-lg shadow-xl border border-gray-200 max-w-md w-full\"\r\n        onClick={e => e.stopPropagation()}\r\n        style={{animation: 'fadeIn 0.2s ease-out'}}\r\n      >\r\n        <div className=\"p-4 border-b border-gray-200 flex justify-between items-center\">\r\n          <h3 className=\"text-lg font-medium text-gray-800\">Add New Task</h3>\r\n          <div className=\"text-xs text-gray-500\">{currentDateTime}</div>\r\n        </div>\r\n        \r\n        <form onSubmit={handleSubmit} className=\"p-4 space-y-4\">\r\n          <div>\r\n            <label htmlFor=\"title\" className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n              Title\r\n            </label>\r\n            <input\r\n              ref={titleInputRef}\r\n              id=\"title\"\r\n              name=\"title\"\r\n              type=\"text\"\r\n              placeholder=\"Enter task title\"\r\n              value={formData.title}\r\n              onChange={handleInputChange}\r\n              className=\"w-full px-3 py-2.5 text-gray-700 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent transition-colors\"\r\n            />\r\n          </div>\r\n          \r\n          <div>\r\n            <label htmlFor=\"description\" className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n              Description\r\n            </label>\r\n            <input\r\n              id=\"description\"\r\n              name=\"description\"\r\n              type=\"text\"\r\n              placeholder=\"Enter description (optional)\"\r\n              value={formData.description}\r\n              onChange={handleInputChange}\r\n              className=\"w-full px-3 py-2.5 text-gray-700 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent transition-colors\"\r\n            />\r\n          </div>\r\n          \r\n          <div className=\"pt-2 flex items-center justify-between\">\r\n            <div className=\"text-xs text-gray-500\">\r\n              Adding as: {currentUser}\r\n            </div>\r\n            \r\n            <div className=\"flex space-x-3\">\r\n              <button\r\n                type=\"button\"\r\n                onClick={handleCancel}\r\n                className=\"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-offset-2\"\r\n              >\r\n                Cancel\r\n              </button>\r\n              \r\n              <button\r\n                type=\"submit\"\r\n                disabled={loading || !formData.title.trim()}\r\n                className={`px-4 py-2 rounded-md text-white text-sm font-medium shadow-sm transition-all duration-200\r\n                  ${loading || !formData.title.trim() \r\n                    ? 'bg-red-400 cursor-not-allowed' \r\n                    : 'bg-red-600 hover:bg-red-700 hover:shadow'}`}\r\n              >\r\n                {loading ? (\r\n                  <div className=\"flex items-center\">\r\n                    <svg className=\"animate-spin -ml-0.5 mr-2 h-3 w-3 text-white\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\r\n                      <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\r\n                      <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\r\n                    </svg>\r\n                    Adding...\r\n                  </div>\r\n                ) : \"Add Task\"}\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n  \r\n  return (\r\n    <>\r\n      {AddButton}\r\n      {mounted && isModalOpen && createPortal(TaskFormModal, document.body)}\r\n      <style jsx global>{`\r\n        @keyframes fadeIn {\r\n          from { opacity: 0; transform: scale(0.95); }\r\n          to { opacity: 1; transform: scale(1); }\r\n        }\r\n      `}</style>\r\n    </>\r\n  );\r\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 422, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 428, "column": 0}, "map": {"version":3,"sources":["file://D%3A/Downloads/Taskoo/TaskManage/src/app/dashboard/page.jsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { signOut, useSession } from \"next-auth/react\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { useEffect, useState, useCallback, useRef } from \"react\";\r\nimport TaskForm from \"@/components/taskForm\";\r\nimport axios from \"axios\";\r\nimport { Toaster, toast } from \"react-hot-toast\";\r\n\r\nexport default function Dashboard() {\r\n  const { data: session, status } = useSession();\r\n  const router = useRouter();\r\n  const [tasks, setTasks] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n\r\n  // Ref to track if a delete operation is in progress\r\n  const deleteInProgress = useRef(false);\r\n\r\n  const fetchTasks = useCallback(async () => {\r\n    if (status !== \"authenticated\" || !session) {\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n\r\n    try {\r\n      const token = session.user.token;\r\n\r\n      if (!token) {\r\n        console.error(\"No token available in session\");\r\n        setError(\"Authentication token missing\");\r\n        setLoading(false);\r\n        return;\r\n      }\r\n\r\n      const response = await axios.get(\"/api/tasks\", {\r\n        headers: {\r\n          Authorization: `Bearer ${token}`,\r\n        },\r\n      });\r\n\r\n      const tasksFromServer = response.data;\r\n      const uniqueTasks = [];\r\n      const seenIds = new Set();\r\n\r\n      for (const task of tasksFromServer) {\r\n        const taskId = task.id || task._id;\r\n        if (taskId && !seenIds.has(taskId)) {\r\n          seenIds.add(taskId);\r\n          uniqueTasks.push(task);\r\n        }\r\n      }\r\n\r\n      setTasks(uniqueTasks);\r\n    } catch (err) {\r\n      console.error(\"Error fetching tasks:\", err);\r\n      setError(\"Failed to load tasks. Please try again.\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [session, status]);\r\n\r\n  const handleTaskAdded = useCallback((newTask) => {\r\n    const newTaskId = newTask.id || newTask._id;\r\n\r\n    if (!newTaskId) {\r\n      console.warn(\"New task missing ID:\", newTask);\r\n      return;\r\n    }\r\n\r\n    setTasks((prevTasks) => {\r\n      const existingTaskIndex = prevTasks.findIndex((task) =>\r\n        (task.id && task.id === newTaskId) || (task._id && task._id === newTaskId)\r\n      );\r\n\r\n      if (existingTaskIndex !== -1) {\r\n        return prevTasks;\r\n      }\r\n\r\n      const toastId = `add-${newTaskId}`;\r\n      toast.success(`Task added successfully`, { id: toastId });\r\n\r\n      return [newTask, ...prevTasks];\r\n    });\r\n  }, []);\r\n\r\n  // Update the handleTaskStatusChange function\r\n  const handleTaskStatusChange = useCallback(\r\n    async (taskId, completed) => {\r\n      if (!session?.user?.token) {\r\n        toast.error(\"Authentication required\", { id: `auth-${taskId}` });\r\n        return;\r\n      }\r\n\r\n      // Use a consistent toast ID\r\n      const toastId = `task-update`;\r\n      \r\n      // Show loading state first\r\n      toast.loading(`${completed ? \"Completing\" : \"Reopening\"} task...`, { id: toastId });\r\n\r\n      // Optimistic update\r\n      setTasks((prevTasks) =>\r\n        prevTasks.map((task) =>\r\n          (task.id === taskId || task._id === taskId)\r\n            ? { ...task, completed }\r\n            : task\r\n        )\r\n      );\r\n\r\n      try {\r\n        const response = await axios.put(\r\n          `/api/tasks/${taskId}`,\r\n          { completed },\r\n          { headers: { Authorization: `Bearer ${session.user.token}` } }\r\n        );\r\n        \r\n        // Replace loading toast with success toast\r\n        toast.success(`Task ${completed ? \"completed\" : \"reopened\"}`, { id: toastId });\r\n      } catch (err) {\r\n        console.error(\"Error updating task:\", err);\r\n        toast.error(\"Failed to update task\", { id: toastId });\r\n        fetchTasks(); // Revert optimistic update on error\r\n      }\r\n    },\r\n    [session, fetchTasks]\r\n  );\r\n\r\n  // Update the handleDeleteTask function\r\n  const handleDeleteTask = useCallback(\r\n    async (taskId) => {\r\n      // Prevent multiple simultaneous delete calls\r\n      if (deleteInProgress.current) {\r\n        console.warn(\"Delete operation already in progress\");\r\n        return;\r\n      }\r\n\r\n      if (!session?.user?.token) {\r\n        toast.error(\"Authentication required\", { id: `auth-del-${taskId}` });\r\n        return;\r\n      }\r\n\r\n      // Set the in-progress flag\r\n      deleteInProgress.current = true;\r\n      \r\n      // Use a consistent toast ID\r\n      const toastId = `task-delete`;\r\n      \r\n      // Show loading state first\r\n      toast.loading(\"Deleting task...\", { id: toastId });\r\n\r\n      // Optimistic delete\r\n      setTasks((prevTasks) =>\r\n        prevTasks.filter((task) => task.id !== taskId && task._id !== taskId)\r\n      );\r\n\r\n      try {\r\n        const response = await axios.delete(`/api/tasks/${taskId}`, {\r\n          headers: { Authorization: `Bearer ${session.user.token}` },\r\n        });\r\n\r\n        if (response.data.success) {\r\n          // Replace loading toast with success toast\r\n          toast.success(\"Task deleted successfully\", { id: toastId });\r\n        } else {\r\n          throw new Error(response.data.message || \"Delete failed\");\r\n        }\r\n      } catch (err) {\r\n        console.error(\"Error deleting task:\", err);\r\n        toast.error(`Failed to delete task: ${err.message || \"Unknown error\"}`, { id: toastId });\r\n        fetchTasks(); // Refresh tasks on error\r\n      } finally {\r\n        deleteInProgress.current = false;\r\n      }\r\n    },\r\n    [session, fetchTasks]\r\n  );\r\n\r\n  useEffect(() => {\r\n    if (status === \"unauthenticated\") {\r\n      router.push(\"/login\");\r\n    }\r\n  }, [status, router]);\r\n\r\n  useEffect(() => {\r\n    fetchTasks();\r\n  }, [fetchTasks]);\r\n\r\n  if (status === \"loading\" || (status === \"authenticated\" && loading)) {\r\n    return (\r\n      <div className=\"flex justify-center items-center h-screen\">\r\n        <p className=\"text-2xl font-bold\">Loading your workload don't Panic!</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <header>\r\n        <nav>\r\n          <div className=\"flex flex-row items-center justify-between p-2 m-3 rounded-full border\">\r\n            <div>\r\n              <h1 className=\"text-2xl font-bold text-green-500 p-1\">Taskoo</h1>\r\n            </div>\r\n            <div className=\"flex flex-row items-center gap-3 text-green-500\">\r\n              {session?.user?.email ? (\r\n                <p className=\"text-sm font-bold border rounded-full p-1\">\r\n                  {session.user.email}\r\n                </p>\r\n              ) : (\r\n                <p>No session data found.</p>\r\n              )}\r\n              <button\r\n                className=\"focus:outline-none text-white bg-red-500 hover:bg-red-600 focus:ring-4 focus:ring-red-300 font-medium rounded-full text-sm p-2 m-2 dark:focus:ring-yellow-900 text-center\"\r\n                onClick={() => signOut()}\r\n              >\r\n                Logout\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </nav>\r\n      </header>\r\n      <div className=\"p-4\">\r\n        <div className=\"flex flex-row items-center justify-between p-3 rounded-2xl\">\r\n          <div>\r\n            <h2 className=\"font-bold text-2xl\">Your Tasks</h2>\r\n          </div>\r\n          <div>\r\n            <TaskForm onTaskAdded={handleTaskAdded} />\r\n          </div>\r\n        </div>\r\n        {error ? (\r\n          <p className=\"text-red-500\">{error}</p>\r\n        ) : tasks.length === 0 ? (\r\n          <p className=\"text-center p-5 text-gray-500\">\r\n            No tasks found. Add your first task!\r\n          </p>\r\n        ) : (\r\n          <div className=\"p-3 flex flex-col space-y-3 rounded-2xl border\">\r\n            {tasks.map((task) => {\r\n              const taskKey = task.id || task._id;\r\n\r\n              if (!taskKey) {\r\n                console.warn(\"Task is missing an ID:\", task);\r\n                return null;\r\n              }\r\n\r\n              return (\r\n                <div\r\n                  key={taskKey}\r\n                  className={`p-3 rounded-2xl border ${\r\n                    task.completed\r\n                      ? \"border-gray-200 bg-gray-50\"\r\n                      : \"border-red-100\"\r\n                  } hover:shadow-md transition-shadow`}\r\n                >\r\n                  <div className=\"flex justify-between items-center\">\r\n                    <div className=\"flex-1\">\r\n                      <div\r\n                        className={\r\n                          task.completed ? \"line-through text-gray-500\" : \"\"\r\n                        }\r\n                      >\r\n                        <strong>{task.title}</strong>\r\n                      </div>\r\n                      {task.description && (\r\n                        <p\r\n                          className={`${\r\n                            task.completed\r\n                              ? \"line-through text-gray-400\"\r\n                              : \"text-gray-600\"\r\n                          }`}\r\n                        >\r\n                          <i>{task.description}</i>\r\n                        </p>\r\n                      )}\r\n                      <p\r\n                        className={`text-sm mt-1 ${\r\n                          task.completed ? \"text-gray-400\" : \"text-gray-600\"\r\n                        }`}\r\n                      >\r\n                        Status: {task.completed ? \"Completed\" : \"Pending\"}\r\n                      </p>\r\n                    </div>\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <button\r\n                        onClick={() =>\r\n                          handleTaskStatusChange(taskKey, !task.completed)\r\n                        }\r\n                        className={`px-3 py-1 rounded-full text-sm ${\r\n                          task.completed\r\n                            ? \"bg-gray-200 hover:bg-gray-300 text-gray-700\"\r\n                            : \"bg-green-200 hover:bg-green-300 text-green-700\"\r\n                        }`}\r\n                      >\r\n                        {task.completed ? \"Reopen\" : \"Complete\"}\r\n                      </button>\r\n                      <button\r\n                        onClick={() => handleDeleteTask(taskKey)}\r\n                        className=\"px-3 py-1 rounded-full text-sm bg-red-200 hover:bg-red-300 text-red-700\"\r\n                      >\r\n                        Delete\r\n                      </button>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n        )}\r\n      </div>\r\n    </>\r\n  );\r\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 910, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{2350:(e,t,s)=>{Promise.resolve().then(s.bind(s,6793))},6793:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>f});var r=s(5155),a=s(2108),o=s(5695),n=s(2115),i=s(9137),l=s.n(i),d=s(7650),c=s(3464),u=s(3568);function m(e){var t;let{onTaskAdded:s}=e,{data:o}=(0,a.useSession)(),[i,m]=(0,n.useState)(!1),[f,x]=(0,n.useState)(!1),[h,p]=(0,n.useState)({title:"",description:""}),[g,y]=(0,n.useState)(!1),b=(0,n.useRef)(null),v=(0,n.useRef)(null),j=(0,n.useRef)(null),k=null==o?void 0:null===(t=o.user)||void 0===t?void 0:t.email,w=new Date().toLocaleDateString();(0,n.useEffect)(()=>(x(!0),()=>x(!1)),[]),(0,n.useEffect)(()=>{i&&b.current&&setTimeout(()=>{b.current.focus()},100)},[i]),(0,n.useEffect)(()=>(i?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[i]);let N=()=>m(!1),A=e=>{let{name:t,value:s}=e.target;p(e=>({...e,[t]:s}))},C=async e=>{var t,r,a;if(e.preventDefault(),!h.title.trim()){u.Ay.error("Please enter a task title");return}let n=u.Ay.loading("Adding task...");y(!0);try{let e=null==o?void 0:null===(t=o.user)||void 0===t?void 0:t.token;if(!e)throw Error("Authentication token missing");let r=await c.A.post("/api/tasks",{title:h.title.trim(),description:h.description.trim(),completed:!1},{headers:{Authorization:"Bearer ".concat(e)}});u.Ay.success("Task added successfully!",{id:n}),p({title:"",description:""}),N(),s&&s(r.data)}catch(e){console.error("Error adding task:",e),u.Ay.error((null===(a=e.response)||void 0===a?void 0:null===(r=a.data)||void 0===r?void 0:r.message)||"Failed to add task",{id:n})}finally{y(!1)}},E=(0,r.jsx)("button",{ref:v,onClick:()=>m(!0),className:"focus:outline-none text-white bg-red-500 hover:bg-red-700 focus:ring-4 focus:ring-red-300 font-medium rounded-xl text-sm p-2 m-1","aria-label":"Add task",type:"button",children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z",clipRule:"evenodd"})})}),S=(0,r.jsx)("div",{ref:j,className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/30 backdrop-blur-sm",onClick:e=>{e.target===j.current&&(h.title||h.description?u.Ay.error("Please use the Cancel button to discard your task"):N())},children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-xl border border-gray-200 max-w-md w-full",onClick:e=>e.stopPropagation(),style:{animation:"fadeIn 0.2s ease-out"},children:[(0,r.jsxs)("div",{className:"p-4 border-b border-gray-200 flex justify-between items-center",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-800",children:"Add New Task"}),(0,r.jsx)("div",{className:"text-xs text-gray-500",children:w})]}),(0,r.jsxs)("form",{onSubmit:C,className:"p-4 space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 mb-1",children:"Title"}),(0,r.jsx)("input",{ref:b,id:"title",name:"title",type:"text",placeholder:"Enter task title",value:h.title,onChange:A,className:"w-full px-3 py-2.5 text-gray-700 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent transition-colors"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,r.jsx)("input",{id:"description",name:"description",type:"text",placeholder:"Enter description (optional)",value:h.description,onChange:A,className:"w-full px-3 py-2.5 text-gray-700 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent transition-colors"})]}),(0,r.jsxs)("div",{className:"pt-2 flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"text-xs text-gray-500",children:["Adding as: ",k]}),(0,r.jsxs)("div",{className:"flex space-x-3",children:[(0,r.jsx)("button",{type:"button",onClick:()=>{(h.title.trim()||h.description.trim())&&u.Ay.success("Task creation cancelled"),p({title:"",description:""}),N()},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-offset-2",children:"Cancel"}),(0,r.jsx)("button",{type:"submit",disabled:g||!h.title.trim(),className:"px-4 py-2 rounded-md text-white text-sm font-medium shadow-sm transition-all duration-200\n                  ".concat(g||!h.title.trim()?"bg-red-400 cursor-not-allowed":"bg-red-600 hover:bg-red-700 hover:shadow"),children:g?(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsxs)("svg",{className:"animate-spin -ml-0.5 mr-2 h-3 w-3 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Adding..."]}):"Add Task"})]})]})]})]})});return(0,r.jsxs)(r.Fragment,{children:[E,f&&i&&(0,d.createPortal)(S,document.body),(0,r.jsx)(l(),{id:"d3ecfebf1841a953",children:"@-webkit-keyframes fadeIn{from{opacity:0;-webkit-transform:scale(.95);transform:scale(.95)}to{opacity:1;-webkit-transform:scale(1);transform:scale(1)}}@-moz-keyframes fadeIn{from{opacity:0;-moz-transform:scale(.95);transform:scale(.95)}to{opacity:1;-moz-transform:scale(1);transform:scale(1)}}@-o-keyframes fadeIn{from{opacity:0;-o-transform:scale(.95);transform:scale(.95)}to{opacity:1;-o-transform:scale(1);transform:scale(1)}}@keyframes fadeIn{from{opacity:0;-webkit-transform:scale(.95);-moz-transform:scale(.95);-o-transform:scale(.95);transform:scale(.95)}to{opacity:1;-webkit-transform:scale(1);-moz-transform:scale(1);-o-transform:scale(1);transform:scale(1)}}"})]})}function f(){var e;let{data:t,status:s}=(0,a.useSession)(),i=(0,o.useRouter)(),[l,d]=(0,n.useState)([]),[u,f]=(0,n.useState)(!0),[x,h]=(0,n.useState)(null),p=(0,n.useCallback)(e=>{d(t=>t.some(t=>t.id===e.id||t._id===e._id)?t:[e,...t])},[]);return((0,n.useEffect)(()=>{"unauthenticated"===s&&i.push("/login")},[s,i]),(0,n.useEffect)(()=>{(async()=>{if("authenticated"===s&&t)try{let e=t.user.token;if(!e){console.error("No token available in session"),h("Authentication token missing"),f(!1);return}let s=await c.A.get("/api/tasks",{headers:{Authorization:"Bearer ".concat(e)}});d(s.data)}catch(e){console.error("Error fetching tasks:",e),h("Failed to load tasks. Please try again.")}finally{f(!1)}})()},[t,s]),"loading"===s||"authenticated"===s&&u)?(0,r.jsx)("p",{children:"Loading..."}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("header",{children:(0,r.jsx)("nav",{children:(0,r.jsxs)("div",{className:"flex flex-row items-center justify-between p-2 m-3 rounded-full border",children:[(0,r.jsx)("div",{children:(0,r.jsx)("h1",{className:"text-2xl font-bold text-green-500 p-1",children:"Taskoo"})}),(0,r.jsxs)("div",{className:"flex flex-row items-center gap-3 text-green-500",children:[(null==t?void 0:null===(e=t.user)||void 0===e?void 0:e.email)?(0,r.jsx)("p",{className:"text-sm font-bold border rounded-full p-1",children:t.user.email}):(0,r.jsx)("p",{children:"No session data found."}),(0,r.jsx)("button",{className:"focus:outline-none text-white bg-red-500 hover:bg-red-600 focus:ring-4 focus:ring-red-300 font-medium rounded-full text-sm p-2 m-2 dark:focus:ring-yellow-900 text-center",onClick:a.signOut,children:"Logout"})]})]})})}),(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsxs)("div",{className:"flex flex-row items-center justify-between p-3 rounded-2xl",children:[(0,r.jsx)("div",{children:(0,r.jsx)("h2",{className:"font-bold text-2xl",children:"Your Tasks"})}),(0,r.jsx)("div",{children:(0,r.jsx)(m,{onTaskAdded:p})})]}),x?(0,r.jsx)("p",{className:"text-red-500",children:x}):0===l.length?(0,r.jsx)("p",{children:"No tasks found."}):(0,r.jsx)("div",{className:"p-3 flex flex-col space-y-3 rounded-2xl border",children:l.map(e=>{let t=e.id||e._id;return t?(0,r.jsxs)("div",{className:"p-3 rounded-2xl border border-red-100 hover:shadow-sm transition-shadow",children:[(0,r.jsx)("strong",{children:e.title}),e.description&&(0,r.jsxs)("p",{children:["Description: ",(0,r.jsx)("i",{children:e.description})]}),(0,r.jsxs)("p",{children:["Status: ",e.completed?"Completed":"Pending"]})]},t):(console.warn("Task is missing an ID:",e),null)})})]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[568,108,227,441,684,358],()=>t(2350)),_N_E=e.O()}]);